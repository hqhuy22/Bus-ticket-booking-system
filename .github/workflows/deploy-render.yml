# ğŸš€ HÆ¯á»šNG DáºªN DEPLOY Tá»ªNG BÆ¯á»šC - VERCEL + RENDER + NEON

## ğŸ“‹ Má»¥c lá»¥c
1. [Giá»›i thiá»‡u Stack](#giá»›i-thiá»‡u-stack)
2. [Chuáº©n bá»‹](#bÆ°á»›c-0-chuáº©n-bá»‹)
3. [Deploy Database (Neon)](#bÆ°á»›c-1-deploy-database-neon)
4. [Deploy Backend (Render)](#bÆ°á»›c-2-deploy-backend-render)
5. [Deploy Frontend (Vercel)](#bÆ°á»›c-3-deploy-frontend-vercel)
6. [Káº¿t ná»‘i Services](#bÆ°á»›c-4-káº¿t-ná»‘i-services)
7. [Testing](#bÆ°á»›c-5-testing)
8. [Setup CI/CD](#bÆ°á»›c-6-setup-cicd-github-actions)

---

## ğŸ¯ Giá»›i thiá»‡u Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND (React + Vite)                    â”‚
â”‚  Platform: Vercel                           â”‚
â”‚  Cost: FREE (Unlimited)                     â”‚
â”‚  URL: https://your-app.vercel.app           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ API Calls
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND (Node.js + Express)                â”‚
â”‚  Platform: Render                           â”‚
â”‚  Cost: FREE (750 hours/month)               â”‚
â”‚  URL: https://your-backend.onrender.com     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Database Queries
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATABASE (PostgreSQL)                      â”‚
â”‚  Platform: Neon                             â”‚
â”‚  Cost: FREE (3GB storage)                   â”‚
â”‚  Connection: Serverless                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–²
                  â”‚ Auto Deploy
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CI/CD (GitHub Actions)                     â”‚
â”‚  Platform: GitHub                           â”‚
â”‚  Cost: FREE (2000 min/month)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### âœ¨ Táº¡i sao chá»n stack nÃ y?

**Vercel (Frontend):**
- âœ… Deploy cá»±c nhanh (< 1 phÃºt)
- âœ… Global CDN tá»± Ä‘á»™ng
- âœ… Zero configuration cho Vite/React
- âœ… Unlimited bandwidth (free tier)
- âœ… Auto SSL/HTTPS
- âœ… Preview deployments cho má»—i PR

**Render (Backend):**
- âœ… Dá»… setup hÆ¡n Railway
- âœ… 750 hours/month free (Ä‘á»§ cháº¡y 1 service 24/7)
- âœ… Tá»± Ä‘á»™ng deploy tá»« GitHub
- âœ… Build & deploy logs chi tiáº¿t
- âœ… Shell access Ä‘á»ƒ run migrations
- âœ… Environment variables management
- âœ… Health checks tá»± Ä‘á»™ng

**Neon (Database):**
- âœ… Serverless PostgreSQL
- âœ… 3GB storage free
- âœ… Auto-scaling
- âœ… Instant database creation
- âœ… Connection pooling built-in
- âœ… Branching database (nhÆ° Git)

**GitHub Actions (CI/CD):**
- âœ… TÃ­ch há»£p sáºµn vá»›i GitHub
- âœ… 2000 minutes/month free
- âœ… Auto test vÃ  deploy
- âœ… Workflow dá»… customize

**Tá»•ng chi phÃ­: $0/thÃ¡ng** ğŸ‰

---

## â±ï¸ Thá»i gian Æ°á»›c tÃ­nh

- **BÆ°á»›c 0** (Chuáº©n bá»‹): 5 phÃºt
- **BÆ°á»›c 1** (Database): 5 phÃºt
- **BÆ°á»›c 2** (Backend): 15 phÃºt
- **BÆ°á»›c 3** (Frontend): 10 phÃºt
- **BÆ°á»›c 4** (Káº¿t ná»‘i): 5 phÃºt
- **BÆ°á»›c 5** (Testing): 5 phÃºt
- **BÆ°á»›c 6** (CI/CD): 20 phÃºt (optional)

**Tá»•ng: 45-60 phÃºt**

---

## BÆ¯á»šC 0: Chuáº©n bá»‹

### âœ… Checklist trÆ°á»›c khi báº¯t Ä‘áº§u

```powershell
# 1. Kiá»ƒm tra Node.js version
node --version
# Cáº§n: v18.0.0 hoáº·c cao hÆ¡n

# 2. Kiá»ƒm tra Git
git --version

# 3. Cháº¡y pre-deployment check
node scripts/pre-deploy-check.mjs

# 4. Äáº£m báº£o code Ä‘Ã£ commit
git status
git add .
git commit -m "Prepare for deployment"
git push origin main
```

### ğŸ“ TÃ i khoáº£n cáº§n táº¡o

| Platform | URL | ÄÄƒng kÃ½ báº±ng |
|----------|-----|--------------|
| **GitHub** | https://github.com | Email (hoáº·c Ä‘Ã£ cÃ³) |
| **Neon** | https://neon.tech | GitHub account |
| **Render** | https://render.com | GitHub account |
| **Vercel** | https://vercel.com | GitHub account |

ğŸ’¡ **Tip:** DÃ¹ng cÃ¹ng 1 GitHub account Ä‘á»ƒ Ä‘Äƒng kÃ½ â†’ dá»… quáº£n lÃ½!

### ğŸ” Chuáº©n bá»‹ thÃ´ng tin

Táº¡o file `deployment-info.txt` (KHÃ”NG commit):

```
deployment-info.txt
-------------------
1. Neon Connection String: [sáº½ láº¥y á»Ÿ bÆ°á»›c 1]
2. Render Backend URL: [sáº½ láº¥y á»Ÿ bÆ°á»›c 2]
3. Vercel Frontend URL: [sáº½ láº¥y á»Ÿ bÆ°á»›c 3]
4. Gmail App Password: [náº¿u dÃ¹ng Gmail]
```

---

## BÆ¯á»šC 1: Deploy Database (Neon)

### 1.1. Táº¡o tÃ i khoáº£n Neon

1. **Truy cáº­p:** https://neon.tech
2. **Click:** "Sign Up"
3. **Chá»n:** "Continue with GitHub"
4. **Authorize Neon**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Neon - Sign Up                     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Continue with GitHub     â”‚ â†   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2. Táº¡o Project má»›i

1. Click **"Create a project"**
2. **Äiá»n thÃ´ng tin:**

```
Project Name:     bus-booking-db
PostgreSQL:       16 (latest)
Region:           Singapore (gáº§n VN nháº¥t)
```

3. Click **"Create Project"**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create New Project                         â”‚
â”‚                                             â”‚
â”‚  Project Name:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ bus-booking-db              â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                             â”‚
â”‚  Region:                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Singapore (ap-southeast-1)  â”‚ â–¼         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                             â”‚
â”‚  [Create Project]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3. Láº¥y Connection String

Sau khi project Ä‘Æ°á»£c táº¡o:

1. **TÃ¬m:** "Connection Details" hoáº·c "Connection String"
2. **Copy connection string:**

```
postgresql://neondb_owner:AbCd1234...@ep-cool-name.ap-southeast-1.aws.neon.tech/neondb?sslmode=require
```

3. **LÆ°u vÃ o** `deployment-info.txt`

âš ï¸ **Quan trá»ng:** 
- Connection string pháº£i cÃ³ `?sslmode=require` á»Ÿ cuá»‘i
- Náº¿u khÃ´ng cÃ³, thÃªm vÃ o manually

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Connection Details                             â”‚
â”‚                                                 â”‚
â”‚  Connection String (recommended):               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ postgresql://user:pass@host/db?ssl...     â”‚ â”‚
â”‚  â”‚                                      [Copy]â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4. Test Connection (Optional)

Trong Neon Dashboard â†’ SQL Editor:

```sql
-- Test query
SELECT version();

-- Náº¿u tháº¥y káº¿t quáº£ PostgreSQL version â†’ OK!
```

âœ… **HoÃ n thÃ nh BÆ°á»›c 1!** Database Ä‘Ã£ sáºµn sÃ ng.

---

## BÆ¯á»šC 2: Deploy Backend (Render)

### 2.1. Táº¡o tÃ i khoáº£n Render

1. **Truy cáº­p:** https://render.com
2. **Click:** "Get Started" hoáº·c "Sign Up"
3. **Chá»n:** "GitHub"
4. **Authorize Render** Ä‘á»ƒ truy cáº­p repos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render - Sign Up                   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Sign up with GitHub      â”‚ â†   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2. Táº¡o Web Service má»›i

1. **Trong Render Dashboard**, click **"New +"**
2. **Chá»n:** "Web Service"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render Dashboard                   â”‚
â”‚                                     â”‚
â”‚  New + â–¼                            â”‚
â”‚    â”œâ”€â”€ Web Service      â†           â”‚
â”‚    â”œâ”€â”€ Static Site                  â”‚
â”‚    â”œâ”€â”€ Cron Job                     â”‚
â”‚    â””â”€â”€ ...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

3. **Connect Repository:**
   - Chá»n **"Connect a repository"**
   - TÃ¬m vÃ  chá»n `bus-ticket-booking-app` repo
   - Click **"Connect"**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Connect Repository                     â”‚
â”‚                                         â”‚
â”‚  Search repositories:                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ bus-ticket-booking-app      â”‚ [ğŸ”] â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  âœ“ bus-ticket-booking-app               â”‚
â”‚    [Connect]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3. Configure Service

Render sáº½ hiá»ƒn thá»‹ form configuration:

**1. Basic Settings:**

```
Name:              bus-booking-backend
Region:            Singapore (closest to VN)
Branch:            main
Root Directory:    bus-booking-server    â† Quan trá»ng!
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service Configuration                  â”‚
â”‚                                         â”‚
â”‚  Name:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ bus-booking-backend         â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  Root Directory:                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ bus-booking-server          â”‚       â”‚ â† Nháº­p vÃ o Ä‘Ã¢y
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**2. Build & Start Commands:**

```
Build Command:     npm install
Start Command:     npm start
```

âš ï¸ **ChÃº Ã½:** Render tá»± Ä‘á»™ng detect Node.js vÃ  cÃ¡c commands nÃ y

**3. Plan:**

```
Instance Type:     Free
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Instance Type                          â”‚
â”‚                                         â”‚
â”‚  â—‹ Starter ($7/month)                   â”‚
â”‚  â— Free (750 hours/month)       â† Chá»n â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4. ThÃªm Environment Variables

Scroll xuá»‘ng pháº§n **"Environment Variables"**:

Click **"Add Environment Variable"** vÃ  thÃªm:

```bash
# 1. Node Environment
NODE_ENV=production

# 2. Port (Render tá»± Ä‘á»™ng inject PORT, nhÆ°ng cÃ³ thá»ƒ set)
PORT=4000

# 3. Database URL (tá»« Neon)
DATABASE_URL=postgresql://neondb_owner:xxxxx@ep-xxx.neon.tech/neondb?sslmode=require

# 4. JWT Secret (generate random string)
JWT_SECRET=your-super-secret-jwt-key-min-32-characters-change-this

# 5. Session Secret (generate random string khÃ¡c)
SESSION_SECRET=your-super-secret-session-key-min-32-characters-change-this

# 6. Client URL (táº¡m thá»i, sáº½ update sau)
CLIENT_URL=http://localhost:5173

# 7. Server URL (Render sáº½ generate, táº¡m Ä‘á»ƒ placeholder)
SERVER_URL=https://placeholder.onrender.com

# 8. Email Configuration
EMAIL_PROVIDER=gmail
EMAIL_SERVICE=gmail
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-gmail-app-password

# 9. Google OAuth (Optional)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_CALLBACK_URL=

# 10. Gemini AI (Optional)
GEMINI_API_KEY=
GEMINI_MODEL=gemini-2.0-flash-exp

# 11. Logging
QUIET_LOGS=false
SQL_LOGGING=false
```

**CÃ¡ch thÃªm:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Environment Variables                  â”‚
â”‚                                         â”‚
â”‚  [+ Add Environment Variable]           â”‚
â”‚                                         â”‚
â”‚  Key:                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ NODE_ENV                    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  Value:                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ production                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ğŸ’¡ **Generate JWT_SECRET:**

```powershell
# Cháº¡y trong PowerShell
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

ğŸ“§ **Gmail App Password:**

1. https://myaccount.google.com/apppasswords
2. Táº¡o app password má»›i
3. Copy 16-digit password

### 2.5. Advanced Settings (Quan trá»ng!)

Scroll xuá»‘ng **"Advanced"** section:

**1. Health Check Path:**

```
Health Check Path:    /api/health
```

Äiá»u nÃ y giÃºp Render biáº¿t service Ä‘Ã£ ready chÆ°a.

**2. Auto-Deploy:**

```
Auto-Deploy:    Yes    â† Enabled (default)
```

### 2.6. Create Web Service

1. **Click:** "Create Web Service"
2. **Render sáº½ báº¯t Ä‘áº§u deploy** (máº¥t 3-5 phÃºt)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Deployment in Progress...              â”‚
â”‚                                         â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60%                 â”‚
â”‚                                         â”‚
â”‚  Building...                            â”‚
â”‚  â””â”€ Running npm install                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.7. Láº¥y Render URL

Sau khi deploy thÃ nh cÃ´ng:

1. **Trong service page**, tÃ¬m URL á»Ÿ Ä‘áº§u trang
2. Format: `https://bus-booking-backend.onrender.com`
3. **Copy vÃ  lÆ°u** vÃ o `deployment-info.txt`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bus-booking-backend                            â”‚
â”‚  https://bus-booking-backend.onrender.com       â”‚
â”‚  â†‘ Copy URL nÃ y                                 â”‚
â”‚                                                 â”‚
â”‚  Status: â— Live                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.8. Update Environment Variables

1. **Trong service page**, click **"Environment"** tab
2. **TÃ¬m vÃ  edit:**

```
SERVER_URL=https://bus-booking-backend.onrender.com
```

3. **Click "Save Changes"**
4. Render sáº½ tá»± Ä‘á»™ng redeploy

### 2.9. Run Database Migrations

1. **Trong service page**, click **"Shell"** tab
2. **Trong shell**, cháº¡y:

```bash
# Sync database tables
npm run sync-db

# Seed data (optional)
npm run seed
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Shell                                  â”‚
â”‚                                         â”‚
â”‚  $ npm run sync-db                      â”‚
â”‚  > Syncing database...                  â”‚
â”‚  âœ“ Tables created successfully          â”‚
â”‚                                         â”‚
â”‚  $ npm run seed                         â”‚
â”‚  > Seeding database...                  â”‚
â”‚  âœ“ Data seeded successfully             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

âš ï¸ **LÆ°u Ã½:** Render Free tier cÃ³ thá»ƒ sleep sau 15 phÃºt khÃ´ng hoáº¡t Ä‘á»™ng. Äiá»u nÃ y bÃ¬nh thÆ°á»ng!

### 2.10. Test Backend

Má»Ÿ browser vÃ  test:

```
https://bus-booking-backend.onrender.com
https://bus-booking-backend.onrender.com/api/health
```

Náº¿u tháº¥y response â†’ Backend OK! âœ…

âœ… **HoÃ n thÃ nh BÆ°á»›c 2!** Backend Ä‘Ã£ live.

---

## BÆ¯á»šC 3: Deploy Frontend (Vercel)

### 3.1. Táº¡o tÃ i khoáº£n Vercel

1. **Truy cáº­p:** https://vercel.com
2. **Click:** "Sign Up"
3. **Chá»n:** "Continue with GitHub"
4. **Authorize Vercel**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel - Sign Up                   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Continue with GitHub     â”‚ â†   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2. Import Project

1. **Click:** "Add New..." â†’ "Project"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel Dashboard                   â”‚
â”‚                                     â”‚
â”‚  Add New... â–¼                       â”‚
â”‚    â”œâ”€â”€ Project          â†           â”‚
â”‚    â””â”€â”€ ...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

2. **Import Git Repository:**
   - TÃ¬m `bus-ticket-booking-app`
   - Click **"Import"**

### 3.3. Configure Project

**1. Project Settings:**

```
Project Name:     bus-booking-app
Framework:        Vite              (auto-detect)
Root Directory:   bus-booking-client    â† Click Edit
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Configure Project                      â”‚
â”‚                                         â”‚
â”‚  Root Directory:                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ bus-booking-client   [Edit] â”‚       â”‚ â† Click Edit
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**2. Build Settings:** (Auto-detect)

```
Build Command:        npm run build
Output Directory:     dist
Install Command:      npm install
```

**3. Environment Variables:**

Click **"Environment Variables"** Ä‘á»ƒ expand:

```
Name:   VITE_API_BASE_URL
Value:  https://bus-booking-backend.onrender.com
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Environment Variables                  â”‚
â”‚                                         â”‚
â”‚  Name:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ VITE_API_BASE_URL           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  Value:                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ https://xxx.onrender.com    â”‚       â”‚ â† Render URL
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  [Add]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

âš ï¸ **ChÃº Ã½:**
- KHÃ”NG cÃ³ dáº¥u `/` á»Ÿ cuá»‘i URL
- Pháº£i prefix `VITE_` Ä‘á»ƒ Vite expose biáº¿n ra client

### 3.4. Deploy

1. **Click:** "Deploy"
2. **Vercel sáº½:**
   - Clone repo
   - Install dependencies
   - Build project
   - Deploy lÃªn CDN global

**Máº¥t khoáº£ng 2-3 phÃºt**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Building...                            â”‚
â”‚                                         â”‚
â”‚  âœ“ Cloned repository                    â”‚
â”‚  âœ“ Installed dependencies               â”‚
â”‚  â–¶ Building (Vite)                      â”‚
â”‚    â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘  75%                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5. Láº¥y Vercel URL

Sau khi deploy thÃ nh cÃ´ng:

1. Báº¡n sáº½ tháº¥y **"Congratulations"** screen
2. URL cÃ³ dáº¡ng:

```
https://bus-booking-app.vercel.app
```

3. **Copy vÃ  lÆ°u** vÃ o `deployment-info.txt`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‰ Your project is live!               â”‚
â”‚                                         â”‚
â”‚  https://bus-booking-app.vercel.app     â”‚
â”‚                                         â”‚
â”‚  [Visit] [Dashboard]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

âœ… **HoÃ n thÃ nh BÆ°á»›c 3!** Frontend Ä‘Ã£ live.

---

## BÆ¯á»šC 4: Káº¿t ná»‘i Services

### 4.1. Update CLIENT_URL trÃªn Render

1. **VÃ o Render service page**
2. **Click "Environment" tab**
3. **Edit biáº¿n `CLIENT_URL`:**

```
CLIENT_URL=https://bus-booking-app.vercel.app
```

4. **Click "Save Changes"**
5. Render sáº½ tá»± Ä‘á»™ng redeploy (1-2 phÃºt)

### 4.2. Verify CORS Configuration

File `bus-booking-server/index.js` nÃªn cÃ³:

```javascript
const cors = require('cors');

app.use(cors({
  origin: [
    'http://localhost:5173',
    'http://localhost:3000',
    process.env.CLIENT_URL,  // Vercel URL
  ],
  credentials: true
}));
```

Náº¿u cáº§n sá»­a, commit vÃ  push â†’ Render auto redeploy.

### 4.3. Update OAuth Callbacks (Náº¿u dÃ¹ng)

**Google OAuth:**

1. **Google Cloud Console:** https://console.cloud.google.com
2. **APIs & Services** â†’ **Credentials**
3. **OAuth 2.0 Client ID** â†’ **Edit**
4. **Add Authorized redirect URIs:**

```
https://bus-booking-backend.onrender.com/api/auth/google/callback
```

5. **Update Render env:**

```
GOOGLE_CALLBACK_URL=https://bus-booking-backend.onrender.com/api/auth/google/callback
```

### 4.4. Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER'S BROWSER                              â”‚
â”‚  Accessing: bus-booking-app.vercel.app       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ HTTPS Requests
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VERCEL CDN (Global)                         â”‚
â”‚  â€¢ Serves static React app                   â”‚
â”‚  â€¢ Auto SSL/HTTPS                            â”‚
â”‚  â€¢ Edge caching                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ API Calls
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RENDER (Singapore)                          â”‚
â”‚  â€¢ Node.js API Server                        â”‚
â”‚  â€¢ Environment: production                   â”‚
â”‚  â€¢ CLIENT_URL: vercel.app âœ…                 â”‚
â”‚  â€¢ DATABASE_URL: neon.tech âœ…                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ PostgreSQL Connection
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NEON (Singapore)                            â”‚
â”‚  â€¢ PostgreSQL 16                             â”‚
â”‚  â€¢ Connection pooling                        â”‚
â”‚  â€¢ Auto-scaling                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

âœ… **HoÃ n thÃ nh BÆ°á»›c 4!** Táº¥t cáº£ services Ä‘Ã£ káº¿t ná»‘i.

---

## BÆ¯á»šC 5: Testing

### 5.1. Test Backend Health

```
https://bus-booking-backend.onrender.com/api/health
```

**Expected:** 
```json
{
  "status": "ok",
  "timestamp": "..."
}
```

### 5.2. Test Frontend

```
https://bus-booking-app.vercel.app
```

**Kiá»ƒm tra:**
- [ ] Trang load Ä‘Æ°á»£c
- [ ] KhÃ´ng cÃ³ lá»—i trong Console (F12)
- [ ] UI hiá»ƒn thá»‹ Ä‘Ãºng

### 5.3. Test API Connection

1. **Má»Ÿ DevTools** (F12)
2. **Network tab**
3. **Thá»­ má»™t tÃ­nh nÄƒng:**
   - Search buses
   - Register user
   - Login

4. **Kiá»ƒm tra:**
   - Request Ä‘áº¿n Render URL? âœ…
   - Status 200? âœ…
   - No CORS errors? âœ…

### 5.4. Test Complete Flow

**User Registration:**

1. Click "Register"
2. Fill form vÃ  submit
3. Check:
   - [ ] User created
   - [ ] Email sent
   - [ ] Can login

**Search & Book:**

1. Login
2. Search buses
3. View details
4. Select seats
5. Book ticket (test mode)

### 5.5. Common Issues & Fixes

#### âŒ Issue 1: Render service sleeping

```
Error: Service unavailable (503)
```

**NguyÃªn nhÃ¢n:** Free tier sleep sau 15 phÃºt inactive

**Fix:** 
- Äá»£i 30-60s cho service wake up
- Hoáº·c upgrade to paid plan
- Hoáº·c dÃ¹ng external monitor (UptimeRobot) Ä‘á»ƒ keep alive

#### âŒ Issue 2: CORS Error

```
Access-Control-Allow-Origin error
```

**Fix:**
1. Verify `CLIENT_URL` trÃªn Render
2. Äáº£m báº£o Ä‘Ãºng Vercel URL
3. No trailing slash

#### âŒ Issue 3: Build timeout trÃªn Render

```
Build exceeded time limit
```

**Fix:**
1. Check `package.json` dependencies
2. Remove unused packages
3. Consider upgrading plan

âœ… **HoÃ n thÃ nh BÆ°á»›c 5!** App hoáº¡t Ä‘á»™ng tá»‘t.

---

## BÆ¯á»šC 6: Setup CI/CD (GitHub Actions)

### 6.1. Láº¥y Render API Key

1. **Render Dashboard** â†’ **Account Settings**
2. Scroll xuá»‘ng **"API Keys"**
3. Click **"Create API Key"**
4. Copy key

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Account Settings                       â”‚
â”‚                                         â”‚
â”‚  API Keys                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ [+ Create API Key]          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2. Láº¥y Render Service ID

1. **VÃ o service page**
2. **Settings tab**
3. Copy **Service ID** (format: `srv-xxxxxxxxxxxxx`)

### 6.3. Láº¥y Vercel Tokens

#### A. Vercel API Token

1. **Vercel Dashboard** â†’ **Settings** â†’ **Tokens**
2. **Create token:**

```
Token Name:     github-actions
Scope:          Full Account
Expiration:     No Expiration
```

3. Copy token

#### B. Vercel Org & Project IDs

```powershell
# Install Vercel CLI
npm install -g vercel

# Login
vercel login

# Link project
cd bus-booking-client
vercel link

# Get IDs
cat .vercel/project.json
```

Output:
```json
{
  "orgId": "team_xxxxx",
  "projectId": "prj_xxxxx"
}
```

### 6.4. ThÃªm GitHub Secrets

1. **GitHub repo** â†’ **Settings** â†’ **Secrets and variables** â†’ **Actions**
2. **Click "New repository secret"**

**Add these secrets:**

| Name | Value | From |
|------|-------|------|
| `RENDER_API_KEY` | `rnd_xxx...` | Render Account Settings |
| `RENDER_SERVICE_ID` | `srv_xxx...` | Render Service Settings |
| `VERCEL_TOKEN` | `xxx...` | Vercel Settings |
| `VERCEL_ORG_ID` | `team_xxx` | `.vercel/project.json` |
| `VERCEL_PROJECT_ID` | `prj_xxx` | `.vercel/project.json` |
| `VITE_API_BASE_URL` | `https://xxx.onrender.com` | Render URL |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  New secret                             â”‚
â”‚                                         â”‚
â”‚  Name:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ RENDER_API_KEY              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  Secret:                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ paste key here              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.5. Create Workflow File

File `.github/workflows/deploy.yml` Ä‘Ã£ cÃ³ sáºµn, nhÆ°ng cáº§n update cho Render:

<function_calls>
<invoke name="create_file">
<parameter name="content">name: Deploy to Production (Vercel + Render)

on:
  push:
    branches: [ main ]
  workflow_dispatch:

env:
  NODE_VERSION: '20'

jobs:
  # ===================================
  # TEST JOB
  # ===================================
  test:
    name: Run Tests
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:16-alpine
        env:
          POSTGRES_USER: postgres
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: bus_booking_test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
          cache-dependency-path: bus-booking-server/package-lock.json

      - name: ğŸ“š Install backend dependencies
        working-directory: ./bus-booking-server
        run: npm ci

      - name: ğŸ§ª Run backend tests
        working-directory: ./bus-booking-server
        env:
          NODE_ENV: test
          PG_HOST: localhost
          PG_PORT: 5432
          PG_USER: postgres
          PG_PASSWORD: postgres
          PG_DATABASE: bus_booking_test
          JWT_SECRET: test-jwt-secret
          SESSION_SECRET: test-session-secret
        run: npm run test:passing

  # ===================================
  # DEPLOY BACKEND TO RENDER
  # ===================================
  deploy-backend:
    name: Deploy Backend to Render
    runs-on: ubuntu-latest
    needs: test
    if: github.ref == 'refs/heads/main'
    
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ¨ Deploy to Render
        uses: johnbeynon/render-deploy-action@v0.0.8
        with:
          service-id: ${{ secrets.RENDER_SERVICE_ID }}
          api-key: ${{ secrets.RENDER_API_KEY }}

  # ===================================
  # DEPLOY FRONTEND TO VERCEL
  # ===================================
  deploy-frontend:
    name: Deploy Frontend to Vercel
    runs-on: ubuntu-latest
    needs: test
    if: github.ref == 'refs/heads/main'
    
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸš€ Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: ./bus-booking-client
          vercel-args: '--prod'

  # ===================================
  # NOTIFICATION JOB
  # ===================================
  notify:
    name: Send Notification
    runs-on: ubuntu-latest
    needs: [deploy-backend, deploy-frontend]
    if: always()
    
    steps:
      - name: ğŸ“§ Send success notification
        if: needs.deploy-backend.result == 'success' && needs.deploy-frontend.result == 'success'
        run: |
          echo "âœ… Deployment successful!"
          echo "Frontend: Deployed to Vercel"
          echo "Backend: Deployed to Render"

      - name: âŒ Send failure notification
        if: needs.deploy-backend.result == 'failure' || needs.deploy-frontend.result == 'failure'
        run: |
          echo "âŒ Deployment failed!"
          exit 1
